<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Botfs23 - Telegram Chat</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="telegram-app">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <button class="btn-menu" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="chat-info">
                    <div class="chat-title" id="chat-title">Botfs23</div>
                    <div class="chat-status">–æ–Ω–ª–∞–π–Ω: <span id="online-count">2</span></div>
                </div>
            </div>
            <div class="header-right">
                <!-- –ö–Ω–æ–ø–∫–∞ —Å–æ–∑—ã–≤–∞ -->
                <button class="btn-mention-all" id="btn-mention-all" onclick="mentionAll()" title="–£–ø–æ–º—è–Ω—É—Ç—å –≤—Å–µ—Ö –æ–Ω–ª–∞–π–Ω">
                    <i class="fas fa-at"></i>
                </button>
                <!-- –ö–Ω–æ–ø–∫–∞ –ø—Ä—ã–∂–∫–∞ –∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º -->
                <button class="btn-jump" id="btn-jump" onclick="jumpToUnread()">
                    <i class="fas fa-arrow-down"></i>
                    <span class="unread-badge" id="unread-badge">0</span>
                </button>
                <!-- –ö–Ω–æ–ø–∫–∞ –∞–¥–º–∏–Ω–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤) -->
                <button class="btn-admin" id="btn-admin" onclick="showAdminPanel()">
                    <i class="fas fa-user-shield"></i>
                </button>
            </div>
        </div>

        <!-- Sidebar —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏ -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="user-profile">
                    <div class="user-avatar" id="user-avatar">
                        <img id="user-avatar-img" src="" alt="" onerror="hideImage(this)">
                        <i class="fas fa-user" id="user-avatar-icon"></i>
                    </div>
                    <div class="user-info">
                        <div class="user-name" id="user-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                        <div class="user-role" id="user-role">—É—á–∞—Å—Ç–Ω–∏–∫</div>
                    </div>
                </div>
                <button class="btn-close-sidebar" onclick="toggleSidebar()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- –°–ø–∏—Å–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ -->
            <div class="sections-list">
                <div class="section-item active" onclick="switchSection('main')">
                    <i class="fas fa-comments"></i>
                    <span class="section-name">–û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç</span>
                    <span class="section-unread" id="main-unread">0</span>
                </div>
                <div class="section-item" onclick="switchSection('news')">
                    <i class="fas fa-newspaper"></i>
                    <span class="section-name">–ù–æ–≤–æ—Å—Ç–∏</span>
                    <span class="section-unread" id="news-unread">0</span>
                </div>
                <div class="section-item" onclick="switchSection('rules')">
                    <i class="fas fa-book"></i>
                    <span class="section-name">–ü—Ä–∞–≤–∏–ª–∞</span>
                    <span class="section-locked"><i class="fas fa-lock"></i></span>
                </div>
                <div class="section-item" onclick="switchSection('announcements')">
                    <i class="fas fa-bullhorn"></i>
                    <span class="section-name">–û–±—ä—è–≤–ª–µ–Ω–∏—è</span>
                    <span class="section-unread" id="announcements-unread">0</span>
                </div>
            </div>
            
            <!-- –ú–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
            <div class="sidebar-menu">
                <div class="menu-item active" onclick="showChat()">
                    <i class="fas fa-comments"></i>
                    <span>–ß–∞—Ç</span>
                    <span class="menu-badge" id="chat-badge">0</span>
                </div>
                <div class="menu-item" onclick="showUsersList()">
                    <i class="fas fa-users"></i>
                    <span>–£—á–∞—Å—Ç–Ω–∏–∫–∏</span>
                    <span class="menu-badge" id="users-badge">0</span>
                </div>
                <div class="menu-item" onclick="showAdminPanel()" id="admin-menu-item">
                    <i class="fas fa-user-shield"></i>
                    <span>–ê–¥–º–∏–Ω–∫–∞</span>
                </div>
            </div>
            
            <div class="sidebar-footer">
                <div class="online-users">
                    <i class="fas fa-circle online-dot"></i>
                    <span id="sidebar-online-count">2</span> –æ–Ω–ª–∞–π–Ω
                </div>
                <div class="app-version">v3.0</div>
            </div>
        </div>

        <!-- –û–≤–µ—Ä–ª–µ–π –¥–ª—è —Å–∞–π–¥–±–∞—Ä–∞ -->
        <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–∞—Ç–∞ -->
        <div class="chat-container active" id="chat-view">
            <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
            <div class="messages-container" id="messages-container">
                <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ -->
            <div class="message-input-area">
                <button class="btn-attach" onclick="toggleAttachMenu()">
                    <i class="fas fa-paperclip"></i>
                </button>
                
                <div class="attach-menu" id="attach-menu">
                    <div class="attach-item" onclick="attachFile('photo')">
                        <i class="fas fa-image"></i>
                        <span>–§–æ—Ç–æ</span>
                    </div>
                    <div class="attach-item" onclick="attachFile('voice')">
                        <i class="fas fa-microphone"></i>
                        <span>–ì–æ–ª–æ—Å–æ–≤–æ–µ</span>
                    </div>
                    <div class="attach-item" onclick="attachFile('document')">
                        <i class="fas fa-file"></i>
                        <span>–î–æ–∫—É–º–µ–Ω—Ç</span>
                    </div>
                    <div class="attach-item" onclick="attachFile('sticker')">
                        <i class="far fa-smile"></i>
                        <span>–°—Ç–∏–∫–µ—Ä</span>
                    </div>
                </div>
                
                <div class="input-wrapper">
                    <textarea 
                        id="message-input" 
                        placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ..."
                        rows="1"
                        onkeypress="handleKeyPress(event)"
                        oninput="autoResize(this)"></textarea>
                    <div class="input-actions">
                        <button class="btn-emoji" onclick="toggleEmojiPicker()">
                            <i class="far fa-smile"></i>
                        </button>
                    </div>
                </div>
                
                <button class="btn-send" onclick="sendMessage()" id="send-button">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
            
            <!-- –≠–º–æ–¥–∑–∏ –ø–∏–∫–µ—Ä -->
            <div class="emoji-picker" id="emoji-picker">
                <div class="emoji-categories">
                    <button class="emoji-category active" onclick="showEmojiCategory('smileys')">üòÄ</button>
                    <button class="emoji-category" onclick="showEmojiCategory('people')">üëã</button>
                    <button class="emoji-category" onclick="showEmojiCategory('symbols')">‚ù§Ô∏è</button>
                    <button class="emoji-category" onclick="showEmojiCategory('nature')">üê∂</button>
                    <button class="emoji-category" onclick="showEmojiCategory('food')">üçï</button>
                </div>
                <div class="emoji-grid" id="emoji-grid"></div>
            </div>
            
            <!-- –ü—Ä–µ–≤—å—é –æ—Ç–≤–µ—Ç–∞ (–±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏) -->
            <div class="reply-preview-container" id="reply-preview-container"></div>
        </div>

        <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
        <div class="admin-container" id="admin-view">
            <div class="admin-header">
                <h2><i class="fas fa-user-shield"></i> –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h2>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–æ–º –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</p>
            </div>
            
            <div class="admin-sections">
                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ -->
                <div class="admin-section">
                    <h3><i class="fas fa-users-cog"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏</h3>
                    <div class="admin-users-list" id="admin-users-list">
                        <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <!-- –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è -->
                <div class="admin-section">
                    <h3><i class="fas fa-user-plus"></i> –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</h3>
                    <div class="admin-actions">
                        <button class="btn-admin-action large" onclick="createInvite()">
                            <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
                        </button>
                        <div class="invites-list" id="invites-list">
                            <!-- –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π -->
                        </div>
                    </div>
                </div>
                
                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞–º–∏ -->
                <div class="admin-section">
                    <h3><i class="fas fa-folder"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞–º–∏</h3>
                    <div class="sections-admin-list">
                        <div class="section-permissions">
                            <div class="permission-item">
                                <span>–û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç:</span>
                                <select class="permission-select" onchange="updateSectionPermission('main', 'write', this.value)">
                                    <option value="all">–í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏</option>
                                    <option value="moderators">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã+</option>
                                    <option value="admins">–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã</option>
                                </select>
                            </div>
                            <div class="permission-item">
                                <span>–ù–æ–≤–æ—Å—Ç–∏:</span>
                                <select class="permission-select" onchange="updateSectionPermission('news', 'write', this.value)">
                                    <option value="all">–í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏</option>
                                    <option value="moderators">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã+</option>
                                    <option value="admins">–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã</option>
                                </select>
                            </div>
                            <div class="permission-item">
                                <span>–ü—Ä–∞–≤–∏–ª–∞:</span>
                                <select class="permission-select" onchange="updateSectionPermission('rules', 'write', this.value)">
                                    <option value="admins">–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã</option>
                                    <option value="moderators">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã+</option>
                                    <option value="all">–í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏</option>
                                </select>
                            </div>
                            <div class="permission-item">
                                <span>–û–±—ä—è–≤–ª–µ–Ω–∏—è:</span>
                                <select class="permission-select" onchange="updateSectionPermission('announcements', 'write', this.value)">
                                    <option value="admins">–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã</option>
                                    <option value="moderators">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã+</option>
                                    <option value="all">–í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- –ê–¥–º–∏–Ω –¥–µ–π—Å—Ç–≤–∏—è -->
                <div class="admin-section">
                    <h3><i class="fas fa-tools"></i> –î–µ–π—Å—Ç–≤–∏—è</h3>
                    <div class="admin-actions">
                        <button class="btn-admin-action danger" onclick="clearChatHistory()">
                            <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞
                        </button>
                        <button class="btn-admin-action danger" onclick="exportChatData()">
                            <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                        </button>
                        <button class="btn-admin-action" onclick="createBackup()">
                            <i class="fas fa-save"></i> –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
        <div class="users-container" id="users-view">
            <div class="users-header">
                <h2><i class="fas fa-users"></i> –£—á–∞—Å—Ç–Ω–∏–∫–∏</h2>
                <div class="users-search">
                    <input type="text" id="users-search-input" placeholder="–ü–æ–∏—Å–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤..." oninput="searchUsers(this.value)">
                </div>
            </div>
            <div class="users-list" id="users-list">
                <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
    </div>

    <!-- –†–µ–∞–∫—Ü–∏–∏ –ø–æ–ø–∞–ø -->
    <div class="reactions-popup" id="reactions-popup">
        <div class="reactions-options">
            <button class="reaction-option" onclick="addReaction('üëç')">üëç</button>
            <button class="reaction-option" onclick="addReaction('‚ù§Ô∏è')">‚ù§Ô∏è</button>
            <button class="reaction-option" onclick="addReaction('üòÇ')">üòÇ</button>
            <button class="reaction-option" onclick="addReaction('üòÆ')">üòÆ</button>
            <button class="reaction-option" onclick="addReaction('üò¢')">üò¢</button>
            <button class="reaction-option" onclick="addReaction('üò°')">üò°</button>
            <button class="reaction-option" onclick="addReaction('üéâ')">üéâ</button>
            <button class="reaction-option" onclick="addReaction('üî•')">üî•</button>
            <button class="reaction-option" onclick="addReaction('üëè')">üëè</button>
            <button class="reaction-option" onclick="addReaction('üôè')">üôè</button>
        </div>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é —Å–æ–æ–±—â–µ–Ω–∏—è -->
    <div class="message-context-menu" id="message-context-menu">
        <div class="context-menu-item" onclick="contextMenuReply()">
            <i class="fas fa-reply"></i>
            <span>–û—Ç–≤–µ—Ç–∏—Ç—å</span>
        </div>
        <div class="context-menu-item" onclick="contextMenuCopyLink()">
            <i class="fas fa-link"></i>
            <span>–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</span>
        </div>
        <div class="context-menu-item" onclick="contextMenuAddToFavorites()">
            <i class="fas fa-star"></i>
            <span>–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
        </div>
        <div class="context-menu-item" onclick="contextMenuForward()">
            <i class="fas fa-share"></i>
            <span>–ü–µ—Ä–µ—Å–ª–∞—Ç—å</span>
        </div>
        <div class="context-menu-item" onclick="contextMenuReaction()">
            <i class="far fa-smile"></i>
            <span>–†–µ–∞–∫—Ü–∏—è</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" onclick="contextMenuEdit()">
            <i class="fas fa-edit"></i>
            <span>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</span>
        </div>
        <div class="context-menu-item" onclick="contextMenuDelete()">
            <i class="fas fa-trash"></i>
            <span>–£–¥–∞–ª–∏—Ç—å</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" onclick="contextMenuReport()">
            <i class="fas fa-flag"></i>
            <span>–ü–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è</span>
        </div>
        <div class="context-menu-item" onclick="contextMenuSelect()">
            <i class="fas fa-check-square"></i>
            <span>–í—ã–±—Ä–∞—Ç—å</span>
        </div>
    </div>

    <!-- –ü–æ–ø–∏–∫–µ—Ä –¥–ª—è –ø–µ—Ä–µ—Å—ã–ª–∫–∏ -->
    <div class="forward-popup" id="forward-popup">
        <div class="forward-header">
            <h3>–ü–µ—Ä–µ—Å–ª–∞—Ç—å –≤...</h3>
            <button class="btn-close-forward" onclick="closeForwardPopup()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="forward-options" id="forward-options">
            <!-- –û–ø—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
    </div>

    <script>
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
        function hideImage(img) {
            img.style.display = 'none';
            const icon = document.getElementById('user-avatar-icon');
            if (icon) icon.style.display = 'block';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–≤—Ç–æ-—Ä–µ—Å–∞–π–∑–∞ textarea
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = (textarea.scrollHeight) + 'px';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é —Å–æ–æ–±—â–µ–Ω–∏—è
        function showMessageMenu(button, messageId) {
            const menu = document.getElementById('message-context-menu');
            const rect = button.getBoundingClientRect();
            
            menu.style.left = (rect.left - 150) + 'px';
            menu.style.top = (rect.top) + 'px';
            menu.style.display = 'block';
            menu.dataset.messageId = messageId;
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –º–µ–Ω—é
            setTimeout(() => {
                const closeHandler = (e) => {
                    if (!menu.contains(e.target) && e.target !== button) {
                        menu.style.display = 'none';
                        document.removeEventListener('click', closeHandler);
                    }
                };
                document.addEventListener('click', closeHandler);
            }, 100);
        }
        
        // –ó–∞–≥–ª—É—à–∫–∏ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é
        function contextMenuReply() {
            const menu = document.getElementById('message-context-menu');
            const messageId = menu.dataset.messageId;
            if (window.replyToMessage) window.replyToMessage(messageId);
            menu.style.display = 'none';
        }
        
        function contextMenuCopyLink() {
            const menu = document.getElementById('message-context-menu');
            const messageId = menu.dataset.messageId;
            // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Å—ã–ª–∫–∏
            navigator.clipboard.writeText(`https://t.me/botfs23/message/${messageId}`);
            alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
            menu.style.display = 'none';
        }
        
        function contextMenuForward() {
            const menu = document.getElementById('message-context-menu');
            const messageId = menu.dataset.messageId;
            if (window.forwardMessage) window.forwardMessage(messageId);
            menu.style.display = 'none';
        }
        
        function contextMenuReaction() {
            const menu = document.getElementById('message-context-menu');
            const messageId = menu.dataset.messageId;
            if (window.showReactionPopup) window.showReactionPopup(messageId);
            menu.style.display = 'none';
        }
        
        function contextMenuDelete() {
            const menu = document.getElementById('message-context-menu');
            const messageId = menu.dataset.messageId;
            if (window.deleteMessage) window.deleteMessage(messageId);
            menu.style.display = 'none';
        }
        
        function closeForwardPopup() {
            document.getElementById('forward-popup').style.display = 'none';
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ—Ç–æ –∏–∑ Telegram, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ
            if (window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                const user = tg.initDataUnsafe?.user;
                
                if (user && user.photo_url) {
                    const img = document.getElementById('user-avatar-img');
                    img.src = user.photo_url;
                    img.style.display = 'block';
                    const icon = document.getElementById('user-avatar-icon');
                    if (icon) icon.style.display = 'none';
                }
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Å–∫—Ä—ã—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            document.getElementById('admin-menu-item').style.display = 'none';
            document.getElementById('btn-admin').style.display = 'none';
            document.getElementById('btn-mention-all').style.display = 'none';
            document.getElementById('admin-view').style.display = 'none';
            document.getElementById('users-view').style.display = 'none';
            
            // –ü—Ä—è—á–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é
            document.getElementById('message-context-menu').style.display = 'none';
            document.getElementById('forward-popup').style.display = 'none';
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —ç–º–æ–¥–∑–∏ –ø–∏–∫–µ—Ä
            if (window.showEmojiCategory) {
                window.showEmojiCategory('smileys');
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            if (window.initApp) {
                setTimeout(() => window.initApp(), 100);
            }
        });
    </script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç -->
    <script src="telegram-chat-extended.js"></script>
</body>
</html>
