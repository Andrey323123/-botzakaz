<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Botfs23 - Telegram Chat</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="loading-screen" id="loading-screen">
        <div class="loading-logo">
            <i class="fab fa-telegram fa-3x"></i>
        </div>
        <div class="loading-text">Botfs23 Chat (S3)</div>
        <div class="loading-subtext" id="loading-subtext">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...</div>
        <div class="loading-spinner"></div>
    </div>

    <!-- –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div id="app" style="display: none;">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <button class="btn-menu" id="btn-menu">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="chat-info">
                    <div class="chat-title" id="chat-title">–û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç (S3)</div>
                    <div class="chat-status">–æ–Ω–ª–∞–π–Ω: <span id="online-count">0</span></div>
                </div>
            </div>
            <div class="header-right">
                <button class="header-btn" id="btn-mention-all" title="–£–ø–æ–º—è–Ω—É—Ç—å –≤—Å–µ—Ö –æ–Ω–ª–∞–π–Ω">
                    <i class="fas fa-at"></i>
                </button>
                <button class="header-btn" id="btn-jump" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º">
                    <i class="fas fa-arrow-down"></i>
                    <span class="unread-badge" id="unread-badge" style="display: none;">0</span>
                </button>
                <button class="header-btn" id="btn-admin" title="–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å">
                    <i class="fas fa-user-shield"></i>
                </button>
                <button class="header-btn" id="btn-users" title="–°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤">
                    <i class="fas fa-users"></i>
                </button>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="user-profile">
                    <div class="user-avatar" id="user-avatar">
                        <i class="fas fa-user" id="user-avatar-icon"></i>
                    </div>
                    <div class="user-info">
                        <div class="user-name" id="user-name">–ì–æ—Å—Ç—å</div>
                        <div class="user-role" id="user-role">—É—á–∞—Å—Ç–Ω–∏–∫</div>
                    </div>
                </div>
                <button class="btn-close-sidebar" id="btn-close-sidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
           
            <!-- –°–ø–∏—Å–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ -->
            <div class="sections-list">
                <div class="section-item active" data-section="main">
                    <i class="fas fa-comments"></i>
                    <span class="section-name">–û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç</span>
                    <span class="section-unread" id="main-unread" style="display: none;">0</span>
                </div>
                <div class="section-item" data-section="news">
                    <i class="fas fa-newspaper"></i>
                    <span class="section-name">–ù–æ–≤–æ—Å—Ç–∏</span>
                    <span class="section-unread" id="news-unread" style="display: none;">0</span>
                </div>
            </div>
           
            <!-- –ú–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
            <div class="sidebar-menu">
                <div class="menu-item active" data-view="chat">
                    <i class="fas fa-comments"></i>
                    <span>–ß–∞—Ç</span>
                    <span class="menu-badge" id="chat-badge" style="display: none;"></span>
                </div>
                <div class="menu-item" data-view="users">
                    <i class="fas fa-users"></i>
                    <span>–£—á–∞—Å—Ç–Ω–∏–∫–∏</span>
                    <span class="menu-badge" id="users-badge" style="display: none;"></span>
                </div>
                <div class="menu-item" data-view="admin">
                    <i class="fas fa-user-shield"></i>
                    <span>–ê–¥–º–∏–Ω–∫–∞</span>
                </div>
                <div class="menu-item" data-view="settings">
                    <i class="fas fa-cog"></i>
                    <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                </div>
                <div class="menu-item" data-view="profile">
                    <i class="fas fa-user"></i>
                    <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
                </div>
            </div>
           
            <div class="sidebar-footer">
                <div class="online-users">
                    <i class="fas fa-circle online-dot"></i>
                    <span id="sidebar-online-count">0/0</span> –æ–Ω–ª–∞–π–Ω
                </div>
                <div class="app-version">v1.0 (S3)</div>
            </div>
        </div>

        <!-- Overlay -->
        <div class="overlay" id="overlay"></div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content">
            <!-- –ß–∞—Ç -->
            <div class="chat-container active" id="chat-view">
                <div class="messages-container" id="messages-container">
                    <div class="empty-chat" id="empty-chat">
                        <i class="fas fa-comments"></i>
                        <p>–ß–∞—Ç –ø—É—Å—Ç–æ–π</p>
                        <small>–ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ –ø–µ—Ä–≤—ã–º!</small>
                    </div>
                </div>
               
                <!-- –ü—Ä–µ–≤—å—é —Ñ–∞–π–ª–æ–≤ -->
                <div class="file-preview" id="file-preview" style="display: none;">
                    <div id="file-preview-container"></div>
                    <div class="file-preview-actions">
                        <button class="btn-admin-action danger" id="btn-cancel-files">–û—Ç–º–µ–Ω–∞</button>
                        <button class="btn-admin-action primary" id="btn-send-files">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                </div>
               
                <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ -->
                <div class="message-input-area">
                    <button class="btn-attach" id="btn-attach">
                        <i class="fas fa-paperclip"></i>
                    </button>
                   
                    <div class="attach-menu" id="attach-menu" style="display: none;">
                        <div class="attach-item" data-type="photo">
                            <i class="fas fa-image"></i><span>–§–æ—Ç–æ</span>
                        </div>
                        <div class="attach-item" data-type="document">
                            <i class="fas fa-file"></i><span>–î–æ–∫—É–º–µ–Ω—Ç</span>
                        </div>
                    </div>
                   
                    <div class="input-wrapper">
                        <textarea id="message-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." rows="1"></textarea>
                        <div class="input-actions">
                            <button class="btn-emoji" id="btn-emoji">
                                <i class="far fa-smile"></i>
                            </button>
                        </div>
                    </div>
                   
                    <button class="btn-send" id="send-button" disabled>
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
            <div class="users-container" id="users-view" style="display: none;">
                <div class="users-header">
                    <h2><i class="fas fa-users"></i> –£—á–∞—Å—Ç–Ω–∏–∫–∏</h2>
                    <div class="users-search">
                        <input type="text" id="users-search-input" placeholder="–ü–æ–∏—Å–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤...">
                        <button class="btn-close-search" id="btn-close-search">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="users-list" id="users-list"></div>
            </div>

            <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
            <div class="admin-container" id="admin-view" style="display: none;">
                <div class="admin-header">
                    <h2><i class="fas fa-user-shield"></i> –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h2>
                    <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–æ–º –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</p>
                </div>
                <div class="admin-sections">
                    <div class="admin-section">
                        <h3><i class="fas fa-users-cog"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏</h3>
                        <div class="admin-users-list" id="admin-users-list"></div>
                    </div>
                    <div class="admin-section">
                        <h3><i class="fas fa-cloud"></i> S3 –°—Ç–∞—Ç—É—Å</h3>
                        <div class="s3-status-info" id="s3-status-panel">
                            <div class="info-item">
                                <strong>–°—Ç–∞—Ç—É—Å:</strong> <span class="settings-status" id="s3-status">–ù–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ</span>
                            </div>
                            <div class="info-item">
                                <strong>–ë–∞–∫–µ—Ç:</strong> <code>telegram-chat-files</code>
                            </div>
                            <button class="btn-admin-action primary" onclick="checkS3Connection()">
                                <i class="fas fa-sync"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å S3
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
            <div class="settings-container" id="settings-view" style="display: none;">
                <div class="settings-header">
                    <h2><i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                </div>
                <div class="settings-list">
                    <div class="settings-item">
                        <span class="settings-label">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
                        <label class="settings-toggle">
                            <input type="checkbox" id="theme-toggle">
                            <span class="settings-toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-item">
                        <span class="settings-label">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                        <label class="settings-toggle">
                            <input type="checkbox" id="notifications-toggle" checked>
                            <span class="settings-toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-item">
                        <span class="settings-label">–ó–≤—É–∫–∏</span>
                        <label class="settings-toggle">
                            <input type="checkbox" id="sounds-toggle" checked>
                            <span class="settings-toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-item">
                        <button class="btn-admin-action primary" id="btn-clear-cache">
                            <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à
                        </button>
                    </div>
                    <div class="settings-item">
                        <button class="btn-admin-action" onclick="exportS3Data()">
                            <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö S3
                        </button>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
            <div class="profile-container" id="profile-view" style="display: none;">
                <div class="profile-header">
                    <h2><i class="fas fa-user"></i> –ü—Ä–æ—Ñ–∏–ª—å</h2>
                </div>
                <div class="profile-info">
                    <div class="user-avatar-large" id="profile-avatar">
                        <i class="fas fa-user fa-3x"></i>
                    </div>
                    <h2 id="profile-name">–ì–æ—Å—Ç—å</h2>
                    <div class="profile-details">
                        <div class="profile-detail">
                            <span class="detail-label">Username:</span>
                            <span class="detail-value" id="profile-username">–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</span>
                        </div>
                        <div class="profile-detail">
                            <span class="detail-label">ID:</span>
                            <span class="detail-value" id="profile-id">000000</span>
                        </div>
                        <div class="profile-detail">
                            <span class="detail-label">–†–æ–ª—å:</span>
                            <span class="detail-value" id="profile-role">—É—á–∞—Å—Ç–Ω–∏–∫</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div class="upload-progress" id="upload-progress" style="display: none;">
            <div id="upload-text">–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...</div>
            <div class="progress-bar-container">
                <div id="progress-bar-fill" class="progress-bar-fill"></div>
            </div>
            <div id="progress-text">0%</div>
        </div>
    </div>

    <!-- Emoji Picker -->
    <div class="emoji-picker" id="emoji-picker" style="display: none;">
        <div class="emoji-categories">
            <button class="emoji-category active" data-category="smileys">üòÄ</button>
            <button class="emoji-category" data-category="animals">üê∂</button>
            <button class="emoji-category" data-category="objects">üí°</button>
            <button class="emoji-category" data-category="symbols">‚ù§Ô∏è</button>
        </div>
        <div class="emoji-grid" id="emoji-grid">
            <!-- Emojis will be inserted here -->
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç -->
    <script src="script.js"></script>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã—Å–æ—Ç—É –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
            function setVh() {
                let vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
            }
            
            setVh();
            window.addEventListener('resize', setVh);
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            setTimeout(() => {
                const loadingScreen = document.getElementById('loading-screen');
                const app = document.getElementById('app');
                
                if (loadingScreen) loadingScreen.classList.add('hidden');
                if (app) {
                    app.style.display = 'flex';
                    app.classList.add('active');
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                if (typeof initApp === 'function') {
                    initApp();
                }
            }, 800);
        });
    </script>
</body>
</html>
