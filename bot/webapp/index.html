<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Botfs23 - Telegram Chat</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="loading-screen" id="loading-screen">
        <div class="loading-logo">
            <i class="fab fa-telegram fa-3x"></i>
        </div>
        <div class="loading-text">Botfs23 Chat</div>
        <div class="loading-subtext" id="loading-subtext">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...</div>
        <div class="loading-spinner"></div>
    </div>

    <!-- –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div id="app" style="display: none;">
        <!-- Header Telegram -->
        <div class="header">
            <div class="header-left">
                <button class="btn-menu" id="btn-menu">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="chat-info">
                    <div class="chat-title" id="chat-title">Botfs23</div>
                    <div class="chat-status">–æ–Ω–ª–∞–π–Ω: <span id="online-count">0</span></div>
                </div>
            </div>
            <div class="header-right">
                <button class="header-btn" id="btn-mention-all" title="–£–ø–æ–º—è–Ω—É—Ç—å –≤—Å–µ—Ö –æ–Ω–ª–∞–π–Ω">
                    <i class="fas fa-at"></i>
                </button>
                <button class="header-btn" id="btn-jump" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º">
                    <i class="fas fa-arrow-down"></i>
                    <span class="unread-badge" id="unread-badge">0</span>
                </button>
                <button class="header-btn" id="btn-admin" title="–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å">
                    <i class="fas fa-user-shield"></i>
                </button>
                <button class="header-btn" id="btn-users" title="–°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤">
                    <i class="fas fa-users"></i>
                </button>
            </div>
        </div>

        <!-- Sidebar Telegram -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="user-profile">
                    <div class="user-avatar" id="user-avatar">
                        <i class="fas fa-user" id="user-avatar-icon"></i>
                    </div>
                    <div class="user-info">
                        <div class="user-name" id="user-name">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        <div class="user-role" id="user-role">—É—á–∞—Å—Ç–Ω–∏–∫</div>
                    </div>
                </div>
                <button class="btn-close-sidebar" id="btn-close-sidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- –°–ø–∏—Å–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ Telegram -->
            <div class="sections-list">
                <div class="section-item active" data-section="main">
                    <i class="fas fa-comments"></i>
                    <span class="section-name">–û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç</span>
                    <span class="section-unread" id="main-unread"></span>
                </div>
                <div class="section-item" data-section="news">
                    <i class="fas fa-newspaper"></i>
                    <span class="section-name">–ù–æ–≤–æ—Å—Ç–∏</span>
                    <span class="section-unread" id="news-unread"></span>
                </div>
                <div class="section-item" data-section="rules">
                    <i class="fas fa-book"></i>
                    <span class="section-name">–ü—Ä–∞–≤–∏–ª–∞</span>
                    <span class="section-locked"><i class="fas fa-lock"></i></span>
                    <span class="section-unread" id="rules-unread"></span>
                </div>
                <div class="section-item" data-section="announcements">
                    <i class="fas fa-bullhorn"></i>
                    <span class="section-name">–û–±—ä—è–≤–ª–µ–Ω–∏—è</span>
                    <span class="section-unread" id="announcements-unread"></span>
                </div>
            </div>
            
            <!-- –ú–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ Telegram -->
            <div class="sidebar-menu">
                <div class="menu-item active" data-view="chat">
                    <i class="fas fa-comments"></i>
                    <span>–ß–∞—Ç</span>
                    <span class="menu-badge" id="chat-badge"></span>
                </div>
                <div class="menu-item" data-view="users">
                    <i class="fas fa-users"></i>
                    <span>–£—á–∞—Å—Ç–Ω–∏–∫–∏</span>
                    <span class="menu-badge" id="users-badge"></span>
                </div>
                <div class="menu-item" data-view="admin" id="admin-menu-item">
                    <i class="fas fa-user-shield"></i>
                    <span>–ê–¥–º–∏–Ω–∫–∞</span>
                </div>
                <div class="menu-item" data-view="settings">
                    <i class="fas fa-cog"></i>
                    <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                </div>
                <div class="menu-item" data-view="profile">
                    <i class="fas fa-user"></i>
                    <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
                </div>
            </div>
            
            <div class="sidebar-footer">
                <div class="online-users">
                    <i class="fas fa-circle online-dot"></i>
                    <span id="sidebar-online-count">0</span> –æ–Ω–ª–∞–π–Ω
                </div>
                <div class="app-version">v3.0</div>
            </div>
        </div>

        <!-- Overlay –¥–ª—è —Å–∞–π–¥–±–∞—Ä–∞ -->
        <div class="overlay" id="overlay"></div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content">
            <!-- –ß–∞—Ç Telegram -->
            <div class="chat-container active" id="chat-view">
                <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π Telegram -->
                <div class="messages-container" id="messages-container">
                    <!-- –°–æ–æ–±—â–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è Telegram -->
                <div class="message-input-area">
                    <button class="btn-attach" id="btn-attach">
                        <i class="fas fa-paperclip"></i>
                    </button>
                    
                    <!-- –ú–µ–Ω—é –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ -->
                    <div class="attach-menu" id="attach-menu">
                        <div class="attach-item" data-type="photo">
                            <i class="fas fa-image"></i>
                            <span>–§–æ—Ç–æ</span>
                        </div>
                        <div class="attach-item" data-type="document">
                            <i class="fas fa-file"></i>
                            <span>–î–æ–∫—É–º–µ–Ω—Ç</span>
                        </div>
                        <div class="attach-item" data-type="sticker">
                            <i class="far fa-smile"></i>
                            <span>–°—Ç–∏–∫–µ—Ä</span>
                        </div>
                        <div class="attach-item" data-type="voice">
                            <i class="fas fa-microphone"></i>
                            <span>–ì–æ–ª–æ—Å–æ–≤–æ–µ</span>
                        </div>
                    </div>
                    
                    <div class="input-wrapper">
                        <textarea 
                            id="message-input" 
                            placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ..."
                            rows="1"></textarea>
                        <div class="input-actions">
                            <button class="btn-emoji" id="btn-emoji">
                                <i class="far fa-smile"></i>
                            </button>
                        </div>
                    </div>
                    
                    <button class="btn-send" id="send-button">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                    
                    <!-- –≠–º–æ–¥–∑–∏ –ø–∏–∫–µ—Ä -->
                    <div class="emoji-picker" id="emoji-picker">
                        <div class="emoji-categories">
                            <button class="emoji-category active" data-category="smileys">üòÄ</button>
                            <button class="emoji-category" data-category="people">üëã</button>
                            <button class="emoji-category" data-category="symbols">‚ù§Ô∏è</button>
                            <button class="emoji-category" data-category="nature">üê∂</button>
                            <button class="emoji-category" data-category="food">üçï</button>
                        </div>
                        <div class="emoji-grid" id="emoji-grid">
                            <!-- –≠–º–æ–¥–∑–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Telegram -->
            <div class="users-container" id="users-view">
                <div class="users-header">
                    <h2><i class="fas fa-users"></i> –£—á–∞—Å—Ç–Ω–∏–∫–∏</h2>
                    <div class="users-search">
                        <input type="text" id="users-search-input" placeholder="–ü–æ–∏—Å–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤...">
                        <button class="btn-close-search" id="btn-close-search">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="users-list" id="users-list">
                    <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>

            <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
            <div class="admin-container" id="admin-view">
                <div class="admin-header">
                    <h2><i class="fas fa-user-shield"></i> –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h2>
                    <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–æ–º –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</p>
                </div>
                
                <div class="admin-sections">
                    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ -->
                    <div class="admin-section">
                        <h3><i class="fas fa-users-cog"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏</h3>
                        <div class="admin-users-list" id="admin-users-list">
                            <!-- –°–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                    
                    <!-- –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è -->
                    <div class="admin-section">
                        <h3><i class="fas fa-key"></i> –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</h3>
                        <button class="btn-admin-action primary large" id="create-invite-btn">
                            <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
                        </button>
                        <div class="invites-list" id="invites-list">
                            <!-- –°–ø–∏—Å–æ–∫ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                    
                    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞–º–∏ -->
                    <div class="admin-section">
                        <h3><i class="fas fa-cogs"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞–º–∏</h3>
                        <div class="sections-admin-list" id="sections-admin-list">
                            <!-- –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                    
                    <!-- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
                    <div class="admin-section">
                        <h3><i class="fas fa-tools"></i> –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                        <div class="admin-actions">
                            <button class="btn-admin-action danger" id="clear-chat-btn">
                                <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞
                            </button>
                            <button class="btn-admin-action" id="export-data-btn">
                                <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
                            </button>
                            <button class="btn-admin-action" id="backup-btn">
                                <i class="fas fa-save"></i> –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
            <div class="settings-container" id="settings-view">
                <div class="settings-header">
                    <h2><i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                </div>
                <div class="settings-list">
                    <div class="settings-item">
                        <span class="settings-label">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
                        <label class="settings-toggle">
                            <input type="checkbox" id="theme-toggle">
                            <span class="settings-toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-item">
                        <span class="settings-label">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                        <label class="settings-toggle">
                            <input type="checkbox" id="notifications-toggle" checked>
                            <span class="settings-toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-item">
                        <span class="settings-label">–ó–≤—É–∫–∏</span>
                        <label class="settings-toggle">
                            <input type="checkbox" id="sounds-toggle" checked>
                            <span class="settings-toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
            <div class="profile-container" id="profile-view">
                <div class="profile-header">
                    <h2><i class="fas fa-user"></i> –ü—Ä–æ—Ñ–∏–ª—å</h2>
                </div>
                <div class="profile-info">
                    <div class="user-avatar-large" id="profile-avatar">
                        <i class="fas fa-user fa-3x"></i>
                    </div>
                    <h2 id="profile-name">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
                    <div class="profile-details">
                        <div class="profile-detail">
                            <span class="detail-label">Username:</span>
                            <span class="detail-value" id="profile-username">@username</span>
                        </div>
                        <div class="profile-detail">
                            <span class="detail-label">ID:</span>
                            <span class="detail-value" id="profile-id">123456</span>
                        </div>
                        <div class="profile-detail">
                            <span class="detail-label">–†–æ–ª—å:</span>
                            <span class="detail-value" id="profile-role">—É—á–∞—Å—Ç–Ω–∏–∫</span>
                        </div>
                        <div class="profile-detail">
                            <span class="detail-label">–°—Ç–∞—Ç—É—Å:</span>
                            <span class="detail-value" id="profile-status">–æ–Ω–ª–∞–π–Ω</span>
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stats-card">
                            <div class="stats-number" id="profile-messages">0</div>
                            <div class="stats-label">–°–æ–æ–±—â–µ–Ω–∏–π</div>
                        </div>
                        <div class="stats-card">
                            <div class="stats-number" id="profile-reactions">0</div>
                            <div class="stats-label">–†–µ–∞–∫—Ü–∏–π</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üì± DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –Ω–∞—á–∏–Ω–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é...');
            
            const loadingScreen = document.getElementById('loading-screen');
            const app = document.getElementById('app');
            const loadingSubtext = document.getElementById('loading-subtext');
            
            // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏
            function updateLoadingStatus(status) {
                if (loadingSubtext) {
                    loadingSubtext.textContent = status;
                }
                console.log('üìä –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏:', status);
            }
            
            // –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            setTimeout(() => {
                updateLoadingStatus('–ü—Ä–æ–≤–µ—Ä–∫–∞ Telegram WebApp...');
                
                try {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Telegram WebApp
                    if (typeof Telegram === 'undefined' || !Telegram.WebApp) {
                        updateLoadingStatus('Telegram WebApp –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞...');
                        console.warn('Telegram WebApp –Ω–µ –Ω–∞–π–¥–µ–Ω, —Ä–∞–±–æ—Ç–∞–µ–º –≤ –±—Ä–∞—É–∑–µ—Ä–Ω–æ–º —Ä–µ–∂–∏–º–µ');
                        
                        // –°–æ–∑–¥–∞–µ–º –∑–∞–≥–ª—É—à–∫—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ
                        window.Telegram = {
                            WebApp: {
                                ready: function() {},
                                expand: function() {},
                                setHeaderColor: function() {},
                                setBackgroundColor: function() {},
                                initDataUnsafe: {
                                    user: {
                                        id: Math.floor(Math.random() * 1000000),
                                        first_name: 'Telegram',
                                        last_name: 'User',
                                        username: 'telegram_user'
                                    }
                                },
                                showAlert: function(msg) { alert(msg); },
                                showPopup: function(options, callback) {
                                    alert(options.message);
                                    if (callback) callback();
                                },
                                BackButton: {
                                    show: function() {},
                                    hide: function() {},
                                    onClick: function() {}
                                },
                                MainButton: {
                                    show: function() {},
                                    hide: function() {},
                                    setText: function() { return this; },
                                    onClick: function() { return this; }
                                }
                            }
                        };
                    }
                    
                    updateLoadingStatus('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞...');
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
                    loadingScreen.classList.add('hidden');
                    app.style.display = 'flex';
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤–æ–≥–æ UI
                    initBasicUI();
                    
                    updateLoadingStatus('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ!');
                    
                    console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                    updateLoadingStatus('–û—à–∏–±–∫–∞: ' + error.message);
                    
                    // –í—Å–µ —Ä–∞–≤–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        loadingScreen.classList.add('hidden');
                        app.style.display = 'flex';
                        initBasicUI();
                        alert('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ');
                    }, 3000);
                }
            }, 1000);
        });
        
        // –ë–∞–∑–æ–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UI
        function initBasicUI() {
            console.log('üé® –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤–æ–≥–æ UI...');
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–æ–∫ –º–µ–Ω—é
            const btnMenu = document.getElementById('btn-menu');
            const btnCloseSidebar = document.getElementById('btn-close-sidebar');
            const overlay = document.getElementById('overlay');
            
            if (btnMenu) btnMenu.addEventListener('click', toggleSidebar);
            if (btnCloseSidebar) btnCloseSidebar.addEventListener('click', toggleSidebar);
            if (overlay) overlay.addEventListener('click', toggleSidebar);
            
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –º–µ–Ω—é
            document.querySelectorAll('.menu-item').forEach(item => {
                item.addEventListener('click', function() {
                    const view = this.getAttribute('data-view');
                    showView(view);
                    updateMenuActive(view);
                    toggleSidebar();
                });
            });
            
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
            document.querySelectorAll('.section-item').forEach(item => {
                item.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    switchSection(section);
                    updateSectionActive(section);
                    toggleSidebar();
                });
            });
            
            // –ö–Ω–æ–ø–∫–∏ —Ö–µ–¥–µ—Ä–∞
            const btnUsers = document.getElementById('btn-users');
            const btnAdmin = document.getElementById('btn-admin');
            const btnMentionAll = document.getElementById('btn-mention-all');
            const btnJump = document.getElementById('btn-jump');
            
            if (btnUsers) btnUsers.addEventListener('click', () => showView('users'));
            if (btnAdmin) btnAdmin.addEventListener('click', () => showView('admin'));
            if (btnMentionAll) btnMentionAll.addEventListener('click', mentionAll);
            if (btnJump) btnJump.addEventListener('click', jumpToUnread);
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
            const sendButton = document.getElementById('send-button');
            const messageInput = document.getElementById('message-input');
            
            if (sendButton) sendButton.addEventListener('click', sendMessage);
            if (messageInput) {
                messageInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                });
            }
            
            // –ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
            const btnAttach = document.getElementById('btn-attach');
            if (btnAttach) btnAttach.addEventListener('click', toggleAttachMenu);
            
            document.querySelectorAll('.attach-item').forEach(item => {
                item.addEventListener('click', function() {
                    const type = this.getAttribute('data-type');
                    attachFile(type);
                    toggleAttachMenu();
                });
            });
            
            // –≠–º–æ–¥–∑–∏
            const btnEmoji = document.getElementById('btn-emoji');
            if (btnEmoji) btnEmoji.addEventListener('click', toggleEmojiPicker);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–º–æ–¥–∑–∏
            initEmojis();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
            updateUserInfo();
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            setTimeout(() => {
                addWelcomeMessage();
            }, 500);
            
            console.log('‚úÖ –ë–∞–∑–æ–≤—ã–π UI –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            if (sidebar && overlay) {
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –≤–∏–¥
        function showView(view) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ
            document.querySelectorAll('.chat-container, .users-container, .admin-container, .settings-container, .profile-container')
                .forEach(container => {
                    container.classList.remove('active');
                });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π
            const targetView = document.getElementById(`${view}-view`);
            if (targetView) {
                targetView.classList.add('active');
            }
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
        function updateMenuActive(view) {
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-view') === view) {
                    item.classList.add('active');
                }
            });
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π —Ä–∞–∑–¥–µ–ª
        function updateSectionActive(section) {
            document.querySelectorAll('.section-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-section') === section) {
                    item.classList.add('active');
                }
            });
            
            // –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫
            const titles = {
                main: '–û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç',
                news: '–ù–æ–≤–æ—Å—Ç–∏',
                rules: '–ü—Ä–∞–≤–∏–ª–∞',
                announcements: '–û–±—ä—è–≤–ª–µ–Ω–∏—è'
            };
            const chatTitle = document.getElementById('chat-title');
            if (chatTitle) {
                chatTitle.textContent = titles[section] || 'Botfs23';
            }
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞
        function switchSection(section) {
            console.log('–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ä–∞–∑–¥–µ–ª:', section);
            showNotification(`–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω —Ä–∞–∑–¥–µ–ª: ${section}`);
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
        function sendMessage() {
            const input = document.getElementById('message-input');
            const text = input?.value.trim();
            
            if (!text || !input) return;
            
            // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            const messageContainer = document.getElementById('messages-container');
            if (!messageContainer) return;
            
            const newMessage = document.createElement('div');
            newMessage.className = 'message outgoing';
            newMessage.innerHTML = `
                <div class="message-content">
                    <div class="message-text">${escapeHtml(text)}</div>
                    <div class="message-status">
                        <i class="fas fa-check"></i>
                        <span>${new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit'})}</span>
                    </div>
                </div>
            `;
            
            messageContainer.appendChild(newMessage);
            input.value = '';
            
            // –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –≤–Ω–∏–∑
            messageContainer.scrollTop = messageContainer.scrollHeight;
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ');
        }
        
        // –£–ø–æ–º—è–Ω—É—Ç—å –≤—Å–µ—Ö
        function mentionAll() {
            const input = document.getElementById('message-input');
            if (input) {
                input.value = '@all ';
                input.focus();
                showNotification('–£–ø–æ–º—è–Ω—É—Ç—ã –≤—Å–µ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏');
            }
        }
        
        // –ü–µ—Ä–µ–π—Ç–∏ –∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º
        function jumpToUnread() {
            const container = document.getElementById('messages-container');
            if (container) {
                container.scrollTop = 0;
                showNotification('–ü–µ—Ä–µ—Ö–æ–¥ –∫ –Ω–∞—á–∞–ª—É —á–∞—Ç–∞');
            }
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –º–µ–Ω—é –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è
        function toggleAttachMenu() {
            const attachMenu = document.getElementById('attach-menu');
            if (attachMenu) {
                attachMenu.classList.toggle('active');
            }
        }
        
        // –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª
        function attachFile(type) {
            showNotification(`–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω —Ñ–∞–π–ª —Ç–∏–ø–∞: ${type}`);
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —ç–º–æ–¥–∑–∏ –ø–∏–∫–µ—Ä
        function toggleEmojiPicker() {
            const emojiPicker = document.getElementById('emoji-picker');
            if (emojiPicker) {
                emojiPicker.classList.toggle('active');
                
                if (emojiPicker.classList.contains('active')) {
                    const emojiGrid = document.getElementById('emoji-grid');
                    if (emojiGrid && emojiGrid.innerHTML === '') {
                        showEmojiCategory('smileys');
                    }
                }
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–º–æ–¥–∑–∏
        function initEmojis() {
            const emojis = {
                smileys: ['üòÄ', 'üòÉ', 'üòÑ', 'üòÅ', 'üòÜ', 'üòÖ', 'üòÇ', 'ü§£', 'üòä', 'üòá', 'üôÇ', 'üôÉ', 'üòâ', 'üòå', 'üòç', 'ü•∞'],
                people: ['üëã', 'ü§ö', 'üñêÔ∏è', '‚úã', 'üññ', 'üëå', 'ü§è', '‚úåÔ∏è', 'ü§û', 'ü§ü', 'ü§ò', 'ü§ô', 'üëà', 'üëâ', 'üëÜ', 'üëá'],
                symbols: ['‚ù§Ô∏è', 'üß°', 'üíõ', 'üíö', 'üíô', 'üíú', 'üñ§', 'ü§ç', 'ü§é', 'üíî', '‚ù§Ô∏è‚Äçüî•', '‚ù§Ô∏è‚Äçü©π', 'üíï', 'üíû', 'üíì', 'üíó'],
                nature: ['üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'ü¶ä', 'üêª', 'üêº', 'üê®', 'üêØ', 'ü¶Å', 'üêÆ', 'üê∑', 'üê∏', 'üêµ', 'üôà'],
                food: ['üçï', 'üçî', 'üçü', 'üå≠', 'üçø', 'ü•ì', 'ü•ö', 'üç≥', 'üßá', 'ü•û', 'üßà', 'üçû', 'ü•ê', 'ü•®', 'ü•Ø', 'ü•ñ']
            };
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–º–∞–π–ª–∏–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            showEmojiCategory('smileys');
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            document.querySelectorAll('.emoji-category').forEach(btn => {
                btn.addEventListener('click', function() {
                    const category = this.getAttribute('data-category');
                    
                    // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                    document.querySelectorAll('.emoji-category').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // –ó–∞–≥—Ä—É–∑–∏—Ç—å —ç–º–æ–¥–∑–∏
                    showEmojiCategory(category);
                });
            });
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é —ç–º–æ–¥–∑–∏
        function showEmojiCategory(category) {
            const emojis = {
                smileys: ['üòÄ', 'üòÉ', 'üòÑ', 'üòÅ', 'üòÜ', 'üòÖ', 'üòÇ', 'ü§£', 'üòä', 'üòá', 'üôÇ', 'üôÉ', 'üòâ', 'üòå', 'üòç', 'ü•∞'],
                people: ['üëã', 'ü§ö', 'üñêÔ∏è', '‚úã', 'üññ', 'üëå', 'ü§è', '‚úåÔ∏è', 'ü§û', 'ü§ü', 'ü§ò', 'ü§ô', 'üëà', 'üëâ', 'üëÜ', 'üëá'],
                symbols: ['‚ù§Ô∏è', 'üß°', 'üíõ', 'üíö', 'üíô', 'üíú', 'üñ§', 'ü§ç', 'ü§é', 'üíî', '‚ù§Ô∏è‚Äçüî•', '‚ù§Ô∏è‚Äçü©π', 'üíï', 'üíû', 'üíì', 'üíó'],
                nature: ['üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'ü¶ä', 'üêª', 'üêº', 'üê®', 'üêØ', 'ü¶Å', 'üêÆ', 'üê∑', 'üê∏', 'üêµ', 'üôà'],
                food: ['üçï', 'üçî', 'üçü', 'üå≠', 'üçø', 'ü•ì', 'ü•ö', 'üç≥', 'üßá', 'ü•û', 'üßà', 'üçû', 'ü•ê', 'ü•®', 'ü•Ø', 'ü•ñ']
            };
            
            const grid = document.getElementById('emoji-grid');
            const categoryEmojis = emojis[category] || emojis.smileys;
            
            if (!grid) return;
            
            grid.innerHTML = '';
            
            categoryEmojis.forEach(emoji => {
                const btn = document.createElement('button');
                btn.className = 'emoji-option';
                btn.textContent = emoji;
                btn.addEventListener('click', () => insertEmoji(emoji));
                grid.appendChild(btn);
            });
        }
        
        // –í—Å—Ç–∞–≤–∏—Ç—å —ç–º–æ–¥–∑–∏
        function insertEmoji(emoji) {
            const input = document.getElementById('message-input');
            if (input) {
                input.value += emoji;
                input.focus();
                toggleEmojiPicker();
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message) {
            console.log('üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:', message);
            if (window.Telegram && Telegram.WebApp && Telegram.WebApp.showAlert) {
                Telegram.WebApp.showAlert(message);
            } else {
                alert(message);
            }
        }
        
        // –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        function updateUserInfo() {
            try {
                const user = Telegram?.WebApp?.initDataUnsafe?.user;
                
                if (user) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –≤ —Å–∞–π–¥–±–∞—Ä–µ
                    const userName = user.first_name + (user.last_name ? ' ' + user.last_name : '');
                    const userAvatar = document.getElementById('user-avatar');
                    const userNameElement = document.getElementById('user-name');
                    
                    if (userNameElement) userNameElement.textContent = userName;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä
                    if (userAvatar && user.photo_url) {
                        const avatarImg = document.createElement('img');
                        avatarImg.src = user.photo_url;
                        avatarImg.onerror = () => {
                            avatarImg.style.display = 'none';
                            const icon = document.getElementById('user-avatar-icon');
                            if (icon) icon.style.display = 'block';
                        };
                        userAvatar.prepend(avatarImg);
                        const icon = document.getElementById('user-avatar-icon');
                        if (icon) icon.style.display = 'none';
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –≤ –ø—Ä–æ—Ñ–∏–ª–µ
                    const profileName = document.getElementById('profile-name');
                    const profileUsername = document.getElementById('profile-username');
                    const profileId = document.getElementById('profile-id');
                    
                    if (profileName) profileName.textContent = userName;
                    if (profileUsername) profileUsername.textContent = user.username ? '@' + user.username : '–±–µ–∑ username';
                    if (profileId) profileId.textContent = user.id;
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:', error);
            }
        }
        
        // –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        function addWelcomeMessage() {
            const container = document.getElementById('messages-container');
            if (!container) return;
            
            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
            container.innerHTML = '';
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            const systemMessage = document.createElement('div');
            systemMessage.className = 'message system';
            systemMessage.innerHTML = `
                <div class="message-content">
                    <div class="message-system">
                        <i class="fas fa-info-circle"></i>
                        <span>üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Botfs23 —á–∞—Ç! –î–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—â–µ–Ω–∏—è –Ω–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.</span>
                    </div>
                </div>
            `;
            
            container.appendChild(systemMessage);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞
            const botMessage = document.createElement('div');
            botMessage.className = 'message incoming';
            botMessage.innerHTML = `
                <div class="message-avatar" style="background: var(--tg-primary);">
                    B
                </div>
                <div class="message-content">
                    <div class="message-header">
                        <div class="message-sender">
                            <span>Botfs23 Bot</span>
                            <span class="message-sender-role user">–ë–æ—Ç</span>
                        </div>
                        <div class="message-time">${new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit'})}</div>
                    </div>
                    <div class="message-text">–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ –¥–µ–º–æ-—á–∞—Ç. –î–ª—è —Å–≤—è–∑–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ @e23esddsbot</div>
                </div>
            `;
            
            container.appendChild(botMessage);
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        window.showChat = function() { showView('chat'); };
        window.showUsersList = function() { showView('users'); };
        window.showAdminPanel = function() { showView('admin'); };
        window.showSettings = function() { showView('settings'); };
        window.showProfile = function() { showView('profile'); };
        window.toggleSidebar = toggleSidebar;
        window.switchSection = switchSection;
        window.showSection = switchSection;
        window.jumpToUnread = jumpToUnread;
        window.mentionAll = mentionAll;
        window.sendMessage = sendMessage;
        window.toggleAttachMenu = toggleAttachMenu;
        window.attachFile = attachFile;
        window.toggleEmojiPicker = toggleEmojiPicker;
        window.showEmojiCategory = showEmojiCategory;
        window.insertEmoji = insertEmoji;
        
        console.log('üì¶ –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
    </script>
</body>
</html>
